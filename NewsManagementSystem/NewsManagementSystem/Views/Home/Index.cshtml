@{
    ViewData["Title"] = "Home Page";
}
<!--Step 1: Add library of JavaScript-->
<head>
    <!-- Add jQuery from a CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://learn.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>

    
</div>

<!--Step 2: Add JavaScript code-->
<script>
        $(document).ready(function () {

            console.log("JWT Token: ", localStorage.getItem("jwt_token"));

        // Function to decode a JWT token
        function decodeJwt(token) {
                var base64Url = token.split('.')[1];
        var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
        return JSON.parse(jsonPayload);
            }

        setTimeout(function () {
                var jwtToken = localStorage.getItem("jwt_token");

        if (jwtToken) { 
                    // Decode the JWT
                    var decodedToken = decodeJwt(jwtToken);

        // Log the details of the JWT token
        console.log("Decoded JWT Token:", decodedToken);
        var role = decodedToken["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];

        // Check if the role is 2
        if (role == "2") {
            // Print "Hello Lecturer"
            $('div.text-center').append('<h2>Hello Lecturer</h2>');
        } else {
            console.log("Role is not 2, navigating to Privacy"); 

            // Navigate to /Account/Privacy
                    window.location.href = "https://localhost:7261/Home/Privacy";
                    }
                } else {
                console.log("Not Login, Navigate to Login");

                // Navigate to /Account/Privacy
                window.location.href = "https://localhost:7261/Account/Login";

                }
            }, 100); // Delay to ensure localStorage is updated
        });

</script>